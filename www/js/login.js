
var LoginPageController = {
    init : function() {
        $(function() {
            LoginPageController.prepare();
        });
    },

    prepare : function() {
        $('#login').on('tappable-tap', function() {
            LoginPageController.login();
        });

        $('#create').on('tappable-tap', function() {
            LoginPageController.create();
        });

        $('#back').on('tappable-tap', function() {
            location.href = 'index.html';
        });
    },

    login : function() {
        var self = this;
        var userName = $('#user-name').val();
        var password = $('#password').val();

        ncmb.User.login(userName, password)
            .then(function(user) {
                // 成功
                alert("ログインに成功しました");
                location.href = 'user.html';
            })
            .catch(function(error) {
                // エラー → 新規登録
                self.create();
            });
    },

    create : function() {
        var userName = $('#user-name').val();
        var password = $('#password').val();

        new ncmb.User({userName : userName, password : password, memo : "generated by test app"})
            .signUpByAccount()
            .then(function() {
                alert("ユーザーが登録されました\nuserName: " + userName);
            })
            .catch(function(err) {
                alert("ユーザー名が既に存在するか、エラーが発生しました");
            });
    }
};
